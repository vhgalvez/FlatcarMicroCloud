


sudo git clone https://github.com/wg-easy/wg-easy.git


[victory@physical1 wg-easy]$ cat docker-compose.yml
services:
  wg-easy:
    image: ghcr.io/wg-easy/wg-easy:latest
    container_name: wg-easy
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    privileged: true
    environment:
      - LANG=es
      - PASSWORD_HASH=$$2a$$12$$2S/MKBOSBAvoVfF4Og02iOaRIzvcHD1NOGG.M2nWAhG9GsgMlz71m
      - WG_DEFAULT_DNS=1.1.1.1
      - WG_HOST=192.168.0.18
      - WG_PORT=51820
    ports:
      - 51820:51820/udp
      - 51821:51821/tcp
    restart: unless-stopped
    sysctls:
      - net.ipv4.conf.all.src_valid_mark=1
      - net.ipv4.ip_forward=1
    volumes:
      - ./wireguard:/etc/wireguard







```bash
sudo setenforce 0
sudo systemctl restart libvirtd
sudo systemctl restart iptables
sudo systemctl status iptables

sudo modprobe nft_nat
sudo modprobe nf_nat
sudo modprobe ip_tables
```


```bash
cat /home/$USER/vpn-Wireguard/wg-easy/wireguard/wg0.conf
```



```ini
# Note: Do not edit this file directly.
# Your changes will be overwritten!

# Server
[Interface]
PrivateKey = 4AQxRkI8XjOX3tiNJBebJjjQERqUhbbX1XAoKqMxGmw=
Address = 10.8.0.1/24
ListenPort = 51820
PreUp =
PostUp =  iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE; iptables -A INPUT -p udp -m udp --dport 51820 -j ACCEPT; iptables -A FORWARD -i wg0 -j ACCEPT; iptables -A FORWARD -o wg0 -j ACCEPT;
PreDown =
PostDown =  iptables -t nat -D POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE; iptables -D INPUT -p udp -m udp --dport 51820 -j ACCEPT; iptables -D FORWARD -i wg0 -j ACCEPT; iptables -D FORWARD -o wg0 -j ACCEPT;


# Client: windows (2c0fdeae-0f46-4dde-afbc-31e52130c1c7)
[Peer]
PublicKey = dbTu+o8/aAcEpUfLiXFPLKTrHtsgnaaUvSu0iSeRwTA=
PresharedKey = dB/i8HbRhxbVgat+cCuiyXxxXb+vrkoPAZdwLpU1RCc=
AllowedIPs = 10.8.0.2/32[victory@physical1 wireguard]$
```


Cliente Windows

```bash

client.conf

```ini
[Interface]
PrivateKey = 4LgWUrp6hcZi/CL8wAmOOAqfgX4OyNA9IBvNalrdi0Y=
Address = 10.8.0.2/24
DNS = 192.168.0.18, 1.1.1.1 

[Peer]
PublicKey = FYYTGsLP1lAF3Ku04/IM41BImhmXnqZqbJTLIMrMgwA=
PresharedKey = dB/i8HbRhxbVgat+cCuiyXxxXb+vrkoPAZdwLpU1RCc=
AllowedIPs = 10.8.0.0/24, 192.168.0.0/24, 10.89.0.0/24, 10.17.3.0/24, 10.17.4.0/24
PersistentKeepalive = 25
Endpoint = 192.168.0.18:51820
```